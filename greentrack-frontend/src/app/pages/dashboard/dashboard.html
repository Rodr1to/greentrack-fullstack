<app-navbar></app-navbar>

<div class="container mt-4">
  
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h1 class="fw-bold">Panel de Control</h1>
      <p class="text-muted">Resumen</p>
    </div>
    
    <div class="d-flex gap-3">
      
      <div>
        <label class="fw-bold small d-block">Marca:</label>
        <select class="form-select form-select-sm" 
                [(ngModel)]="selectedBrand" 
                aria-label="Filtrar por marca">
          <option *ngFor="let brand of brands$ | async" [value]="brand">
            {{ brand }}
          </option>
        </select>
      </div>

      <div>
        <label class="fw-bold small d-block">Tipo:</label>
        <select class="form-select form-select-sm" 
                [(ngModel)]="selectedType" 
                aria-label="Filtrar por tipo">
          <option *ngFor="let type of types$ | async" [value]="type">
            {{ type }}
          </option>
        </select>
      </div>

    </div>
  </div>

  <ng-container *ngIf="stats$ | async as stats; else loading">
    <div class="row row-cols-1 row-cols-md-3 g-4 mb-5">
      
      <div class="col">
        <div class="card bg-primary text-white h-100 shadow-sm border-0">
          <div class="card-body d-flex flex-column justify-content-center text-center py-4">
            <h6 class="card-title opacity-75 text-uppercase">Total Equipos</h6>
            <h1 class="display-3 fw-bold mb-0">{{ stats.totalEquipos }}</h1>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card bg-success text-white h-100 shadow-sm border-0">
          <div class="card-body d-flex flex-column justify-content-center text-center py-4">
            <h6 class="card-title opacity-75 text-uppercase">Disponibles</h6>
            <h1 class="display-3 fw-bold mb-0">{{ stats.disponibles }}</h1>
          </div>
        </div>
      </div>

      <div class="col">
        <div class="card bg-warning text-dark h-100 shadow-sm border-0">
          <div class="card-body d-flex flex-column justify-content-center text-center py-4">
            <h6 class="card-title opacity-75 text-uppercase">Prestados</h6>
            <h1 class="display-3 fw-bold mb-0">{{ stats.prestados }}</h1>
          </div>
        </div>
      </div>

    </div>
  </ng-container>

  <ng-template #loading>
    <div class="text-center py-5">
      <div class="spinner-border text-primary" role="status"></div>
      <p class="mt-2 text-muted">Sincronizando datos...</p>
    </div>
  </ng-template>
  
<div class="row g-4"> <div [ngClass]="isAdmin ? 'col-md-4' : 'col-md-6'">
        <div class="card p-4 border-0 shadow-sm text-center h-100">
            <h3 class="fw-bold text-dark">Inventario</h3>
            <p class="text-muted">Stock y existencias</p>
            <button routerLink="/equipments" class="btn btn-outline-primary mt-3 px-4">
                Ver Lista
            </button>
        </div>
    </div>

    <div [ngClass]="isAdmin ? 'col-md-4' : 'col-md-6'">
        <div class="card p-4 border-0 shadow-sm text-center h-100">
            <h3 class="fw-bold text-dark">Préstamos</h3>
            <p class="text-muted">Salidas de equipos y devoluciones</p>
            <button routerLink="/loans" class="btn btn-outline-success mt-3 px-4">
                Gestionar
            </button>
        </div>
    </div>

    <div class="col-md-4" *ngIf="isAdmin">
        <div class="card p-4 border-0 shadow-sm text-center h-100"> <h3 class="fw-bold text-dark">Usuarios</h3>
            <p class="text-muted">Gestión de acceso y roles</p>
            <button routerLink="/users" class="btn btn-dark mt-3 px-4">
                Gestionar
            </button>
        </div>
    </div>

</div>